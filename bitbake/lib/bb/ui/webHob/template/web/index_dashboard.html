	{% extends 'web/base.html' %}
	{% block current_user %} {{ current_user }} {% endblock %}
	{% block javascrip%}
	<script type="text/javascript">
		var timer = null;
		$(function(){
			var is_getPercent = $("#is_getPercent").val();
			if(is_getPercent != ""){
				timer=setInterval('getProgressPercent()','1000');
			}
		});
		function getProgressPercent(){
			var current_user = $("#current_user").val();
			$.get("/hob/builds/getProgressBar/",
					{"current_user": current_user,
					'value': Math.random()},
					function(data){
						json = jQuery.parseJSON(data);
						if(json.progressPercents){
							for(var i=0;i<json.progressPercents.length;i++){
								var dashboard_id = "progress_dashboard_"+json.progressPercents[i].guid;
								var bar_id = "progress_bar_"+json.progressPercents[i].guid;
								var bar_name = "name_"+json.progressPercents[i].guid;
								var bar_guid ="guid_"+json.progressPercents[i].guid;
								var bar_buildtask ="buildtask_"+json.progressPercents[i].guid;
								if(parseInt(json.progressPercents[i].percent) < 100){
									$("#"+dashboard_id).html("<div class='bar' style='width: "+json.progressPercents[i].percent+"%;'> building "+json.progressPercents[i].percent+"%</div>");
									$("#"+bar_id).html("<div class='bar' style='width: "+json.progressPercents[i].percent+"%;'> building "+json.progressPercents[i].percent+"%</div>");
									$("#"+bar_name).html("name:"+json.progressPercents[i].name);
									$("#"+bar_guid).html("guid:"+json.progressPercents[i].guid+"  |  ");
									$("#"+bar_buildtask).html("build task:"+json.progressPercents[i].buildTask);
								}
							}
						}
						if(json.progressPercents.length == 0){
							clearInterval(timer);
							window.location = "/hob/builds/index/?current_user="+current_user;
						}
					},"text");
		}
		function checkAll(obj){
			var checkName = $(obj).val();
			if($(obj).attr("checked")){
				$("[name='"+checkName+"']").attr("checked",'true');
			}else{
				$("[name='"+checkName+"']").removeAttr("checked");
			}
		}
		function download_item_isSelected_check(param){
			if($("input[name='"+param+"']:checked").length == 0){
				alert("at least one option is selected");
			}else{
				$('#downloadForm').submit();
			}
		}
	</script>
	{% endblock %}
	{% block content %}
	<input type="hidden" name="current_user" id="current_user" value="{{ current_user }}"/>
	<input type="hidden" name="is_getPercent" id="is_getPercent" value="{{ is_getPercent }}"/>
	<!-- Main Content -->
	<div id="main" class="container">
		<div class="row main">
			<div class="span8">
				<div class="row">
					<div class="span8">
						<h2 class="inline"><a href="builds.html">Builds</a></h2>
					</div>
					<div class="span8">
						{% if not buildings and not builds %}
						<div class="alert alert-info" align="center">
							<strong>No Available Builds!</strong>
						</div>
						{% endif %}
						{% if buildings %}
						<!--MY BUILDS-->
						<div class="alert alert-success">
							<strong>All done! </strong>You have successfully made an image with everything you picked.<button type="button" class="close" data-dismiss="alert">x</button>
						</div>
						<!--BUILD STATUSES-->
						{% for val in buildings %}
						<!--Build Status1-->
						{% if val.is_finished %}
						<p><a href="#"><i class="icon-book"></i> {{ val.name }}_{{ val.guid }}</a></p>
						<div class="row">
							<div class="span4">
								<div class="progress progress-success"><div class="bar" style="width: 100%;">COMPLETE!</div></div>
							</div>
							<div class="span2 copy12">{{ val.estimated_size }} MB</div>
							<div class="span2 copy12">&nbsp;</div>
						</div>
						{% endif %}
						<!--Build Status1-->
						<!--Build Status2-->
						{% if not val.is_finished %}
						<p><a href="#"><i class="icon-book"></i> {{ val.name }}_{{ val.guid }}</a></p>
						<div class="row" id="current_building_progress">
							<div class="span4">
								<div class="progress"><div id="progress_dashboard_{{val.guid}}"><div class="bar" style="width: {{val.build_percent}}%;">building {{val.build_percent}}%</div></div></div>
							</div>
						</div>
						{% endif %}
						<!--Build Status2-->
						{% endfor %}
						<!--BUILD STATUSES-->
						<!--MY BUILDS-->
						{% endif %}
						{% if builds %}
						<!--ALL BUILDS-->
						{% for val in builds %}
						<table class="build_table">
							<tr>
								<td class="col_one"><a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion1" href="#{{val.guid}}">{{ val.name }}</a></td>
								<td class="col_two"><a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion1" href="#{{val.guid}}">{{ val.size }}MB</a></td>
								<td class="col_three"><a href="#">{{ val.create_date|date:"m/d/Y H:i:s"}}</a></td>
								<td class="col_four"><span class="label">{{ val.project.name }}</span></td>
								<td class="col_five"><i class="icon-user"></i> <a href="#">{{ val.operator.name }}</a></td>
							</tr>
						</table>
						<!--Collapsed-->
						<div id="{{val.guid}}" class="accordion-body collapse">
							<div class="accordion-inner well">
							<form id="downloadForm" action="#" method="post">
								<table class="table table-bordered table-striped">
									{% for item in val.images.all %}
									<tr>
										<td><i class="icon-download_alt"></i> <a href="{{item.url}}">{{item.name}}</a></td>
										<td>{{item.size}} MB</td>
										<td><a href="{{item.url}}"><i class="icon-download-alt"></i>Download</a></td>
									</tr>
									{% endfor %}
								</table>
							</form>
							</div>
						</div>
						{% endfor %}
						<!--Collapsed-->
						<!--ALL BUILDS-->
						{% endif %}
						<div class="row">
							<div class="span4">
								<div class="well2">
								<h2><a href="/hob/groups/index/?current_user={{ current_user }}">My Groups</a></h2>
								<ul>
								{% for val in groups %}
								<li><a href="/hob/groups/index/?current_user={{ current_user }}">{{ val.name }}</a></li>
								{% endfor %}
								</ul>
								<a class="btn btn-primary" href="/hob/groups/index/?current_user={{ current_user }}">
								<i class="icon-plus-sign icon-white"></i> Start a new group
								</a>
								</div>
							</div>
							<div class="span4">
								<div class="well2">
								<h2><a href="/hob/projects/index/?current_user={{ current_user }}&current_project=">My Projects</a></h2>
								<ul>
								{% for val in projects %}
								<li><a href="/hob/projects/projects_myproject/?current_user={{ current_user }}&current_project={{ val.name }}">{{ val.name }}</a></li>
								{% endfor %}
								</ul>
								<a class="btn btn-primary" href="/hob/projects/index/?current_user={{ current_user }}&current_project=">
								<i class="icon-plus-sign icon-white"></i> Start a new project
								</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="span4">
				<div class="well">
				<h3>Yocto News</h3>
				<ul class="homenews">
					<li><a href="#">Documentation? They call it code for a reason.</a> - Elizabeth Flanagan - 18 May 2012 - 10:54</li>
					<li><a href="#">Build Appliance: Eating Your Own Dog Food</a> - Saul Wold - 7 May 2012 - 13:04</li>
					<li><a href="#">Yocto Project 1.2 Now Available</a> - Jeffrey Osier-Mixon - 30 Apr 2012 - 17:11</li>
					<li><a href="#">A quick Yocto-grid</a> - David Stewart - 24 Apr 2012 - 08:44</li>
					<li><a href="#">The Yocto-yumminess of our BSPs</a> - David Stewart - 6 Apr 2012 - 16:21</li>
					<li><a href="#">more &#187</a></li>
				</ul>
				</div>
				<div class="well">
				<h3>Latest Activity</h3>
				<p><a href="#">Yesterday 14:45</a><br />
				Changed settings on <span class="label label-important">Yocto Block rollout</span></p>
				<p><a href="#">Yesterday 14:43</a><br />
				Selected <a href="#">busybox-1.19.4</a> in <a href="#">Features</a></p>
				<p><a href="#">Two days ago at 14:35</a><br />
				Invited <a href="#"><i class="icon-user"></i> Joe Thomason</a> <span class="label label-important">Yocto Block rollout</span></p>
				<p><a href="#">25 May 2012 14:15</a><br />
				Added <a href="#">busybox-1.19.4</a> in <a href="#">Features</a></p>
				</div>
			</div>

		</div>
		<!--Queue Modal Content-->
		<div id="queueModal" class="modal hide">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h3>Running Builds</h3>
			</div>
			<div class="modal-body">
			{% if buildings %}
				{% for val in buildings %}
				{% if not val.is_finished %}
				<h4><span id="name_{{val.guid}}"></span></h4>
				<p><span id="guid_{{val.guid}}"></span><span id="buildtask_{{val.guid}}"></span></p>
				<div class="progress progress-striped active"><div id="progress_bar_{{val.guid}}"><div class="bar" style="width: {{val.build_percent}}%;">building {{val.build_percent}}%</div></div></div>
				{% endif %}
				{% endfor %}
			{% else %}
				<div class="alert alert-info" align="center">
					<strong><i class=" icon-warning-sign"></i>&nbsp;There are no building tasks !</strong>
				</div>
			{% endif %}
			</div>
			<div class="modal-footer"><a href="#" class="btn" data-dismiss="modal" >Close</a></div>
		</div>
		<!--Queue Modal Content-->
	</div>
	<!-- Main Content -->
	{% endblock %}